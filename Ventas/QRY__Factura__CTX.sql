--QUERY Documento Factura COLNOTEXSA
USE COLNOTEXSA;
select * from trade WHERE origen='FAC' AND TIPODCTO='FA' AND NRODCTO='120244';
-- Encabezado 
select NRODCTO,FECHA,FECHA1,CODVEN,NIT,TIPODCTO,CODCC,TIPOVTA from trade WHERE origen='FAC' AND TIPODCTO='FA' AND NRODCTO='120244';
--1 Datos Documento
USE VERONASAS;
select NRODCTO,FECHA,FECHA1 from trade WHERE trade.origen='FAC' AND trade.FECHA between '20250101' AND '20250228' AND trade.TIPODCTO='23' AND NIT='1000119349-9';
--2 Datos Cliente
select TIPOVTA,CODIGOCTA,TIPOCAR,CODINT,TIPOMVTO,CODCC,DESCECOL from trade WHERE trade.origen='FAC' AND trade.FECHA between '20250101' AND '20250228' AND trade.TIPODCTO='23' AND NIT='1000119349-9';
--4 Datos Generales
select DIR,CIUDADCLI from trade WHERE trade.origen='FAC' AND trade.FECHA between '20250101' AND '20250228' AND trade.TIPODCTO='23' AND NIT='1000119349-9';
--5 Datos Triutarios
select CODRETE,XRETIVA,CODICA,XRETICA,PRETECREE,PORAIU from trade WHERE trade.origen='FAC' AND trade.FECHA between '20250101' AND '20250228' AND trade.TIPODCTO='23' AND NIT='1000119349-9';
--5 Moneda Negociacion
select TIPOMONEDA,TCAMBIO from trade WHERE trade.origen='FAC' AND trade.FECHA between '20250101' AND '20250228' AND trade.TIPODCTO='23' AND NIT='1000119349-9';
--6 Totales
select BRUTO,IVABRUTO,(BRUTO+IVABRUTO) as BRUTO,DESCUENTO,((BRUTO+IVABRUTO)-DESCUENTO) as TOTAL from trade WHERE trade.origen='FAC' AND trade.FECHA between '20250101' AND '20250228' AND trade.TIPODCTO='23' AND NIT='1000119349-9';
--Actividad Funciona pero falta
select NIT,NRODCTO,TIPODCTO,TRADE.MEDIOPAG,MTMEDPAG.DESCRIPCIO as TIPO_CAMBIO,(BRUTO+IVABRUTO) as BRUTO,DESCUENTO,IVABRUTO,((BRUTO+IVABRUTO)-DESCUENTO) as TOTAL_BRUTO 
from trade INNER JOIN 
MTMEDPAG ON TRADE.MEDIOPAG=MTMEDPAG.MEDIOPAG 
WHERE trade.origen='FAC' AND trade.FECHA between '20250101' AND '20250228' AND  trade.TIPODCTO='23' AND trade.NIT='1000119349-9';
--Actividad 2
select trade.NIT,NRODCTO,trade.TIPODCTO,TRADE.MEDIOPAG,MTMEDPAG.DESCRIPCIO as TIPO_CAMBIO,(BRUTO+IVABRUTO) 
as BRUTO,DESCUENTO,IVABRUTO,((BRUTO+IVABRUTO)-DESCUENTO) as TOTAL_BRUTO, MVCUADRE.VALOR
from trade INNER JOIN 
MTMEDPAG ON TRADE.MEDIOPAG=MTMEDPAG.MEDIOPAG 
INNER JOIN
MVCUADRE ON  trade.NIT=MVCUADRE.NIT
WHERE trade.NIT='1000119349-9' AND trade.origen='FAC' AND trade.FECHA between '20250101' AND '20250228' AND  trade.TIPODCTO='23';
--Posibles ayudas
select * from MTMEDPAG;
USE VERONASAS;
select * from MVCUADRE WHERE NIT='1000119349-9' AND MVCUADRE.FECHAMVTO between '20250101' AND '20250131';
select * from TRADE WHERE NIT='1000119349-9';

